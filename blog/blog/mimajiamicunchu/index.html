<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.64">
    <title>密码加密存储 | Vuepress Theme Blue</title><meta name="description" content="">
    <link rel="preload" href="/blog/assets/style-d97c5f5a.css" as="style"><link rel="stylesheet" href="/blog/assets/style-d97c5f5a.css">
    <link rel="modulepreload" href="/blog/assets/app-c399b13a.js"><link rel="modulepreload" href="/blog/assets/index.html-b5ba2271.js"><link rel="modulepreload" href="/blog/assets/index.html-98c2c35b.js"><link rel="prefetch" href="/blog/assets/404.html-30afe3c5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-87180724.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ed0fd3d1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-817918d0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ab2771d8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-62bdddc1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0aaea317.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-362e5eda.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-22e9a1e5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-03899184.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bd04de7d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8432d7c2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f4bc7919.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-266cfb01.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b2cc8270.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-98c00800.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ae33ec0f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9f76b2fb.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a8dc90b6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3d3599dc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cdee76d8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0a493daa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3f6e11fd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-23399167.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a9560cb8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bb530bb0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0e1d1c06.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0c076014.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b5f11fde.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e965da56.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d03c30ac.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-718a010f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-023f9a25.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-782e61bb.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b53b6fcb.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-620675de.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b7cf35a2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-52791d54.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-404c3b2e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-fabfc81c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f692a8a6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d9618c98.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8fb78894.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3da56c89.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4b594f0f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e14ec4b7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3ff531d7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ea362abf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-df93660b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f5f5632b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-164449d6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-295b3ade.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-d49f5b6c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3d56a85e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b25195bc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3ed2d8de.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6f8c0898.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-07b3079d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0be69411.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-fdda7cff.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cbfaad4e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d74466a6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7c601293.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9fba6630.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f3c7886c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-74710945.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-26ef95f3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e27180c5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d5e11385.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-99050c42.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-84e9c903.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c26f1767.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7b9537d9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f6e04f80.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5ea30b49.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d0ba582a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6d7b6a82.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1a2e7435.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0a73655b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-44d5e4bb.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9f56b90d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b230492d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-fc32154a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-06940df8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7484fce6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6160feaf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1644dc97.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2d2fd2b7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-548eb62d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-81d51707.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3d341f97.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3f7d8bd3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bf4b496e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8e0cff90.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-26d8252a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f8c84bc8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a44e698e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b5574d9c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0c85a077.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7cb89255.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-375bbbc4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-71d119d8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3fe7b7c1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-15d99d75.js" as="script"><link rel="prefetch" href="/blog/assets/giscus-2a044aea-497f0bd4.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><div class="nav" data-v-a231a75e data-v-ad3cbd41><div class="container" data-v-ad3cbd41><!--[--><a href="/blog/" class="nav-action-wrapper" data-v-ad3cbd41><div class="nav-action" data-v-ad3cbd41>首页</div></a><a href="/blog/category" class="nav-action-wrapper" data-v-ad3cbd41><div class="nav-action" data-v-ad3cbd41>分类</div></a><!--]--></div></div><div class="container" data-v-a231a75e><!--[--><div class="blog-page" data-v-dd29a953><div class="card blog" data-v-dd29a953 data-v-2e70653c><!--[--><div class="banner" data-v-dd29a953><img class="banner-img" src="http://static.mittacy.com/blog/202109041547534.jpg" alt="Banner" data-v-dd29a953></div><h1 class="title" data-v-dd29a953>密码加密存储</h1><div class="markdown-body content" data-v-dd29a953><p>2011年12月，<a href="https://baike.baidu.com/item/%E5%AF%86%E7%A0%81%E5%A4%96%E6%B3%84%E9%97%A8/4976608?fr=aladdin" target="_blank" rel="noopener noreferrer">密码外泄门</a> 造成了CSDN 2010年9月之前600多万明文帐号数据泄露，对用户账号造成了威胁。</p><p>CSDN发布声明：</p><blockquote><p>我们非常抱歉，发生了CSDN用户数据库泄露事件，您的用户密码可能被公开。我们恳切地请您修改CSDN相关密码，如果您在其他网站也使用同一密码。请一定同时修改相关网站的密码。</p><p>CSDN已向公安机关正式报案，公安机关也正在调查相关线索。</p><p>再次向您致以深深的歉意！</p></blockquote><p>可见，明文存储密码是很危险的，我们应该对用户的密码进行加密存储，并且这个加密过程是不可逆的！</p><h3 id="_1-用户注册和登录验证" tabindex="-1"><a class="header-anchor" href="#_1-用户注册和登录验证" aria-hidden="true">#</a> 1. 用户注册和登录验证</h3><p>密码加密不可逆后，又要怎么验证用户登录时输入的密码正确性呢？</p><p>我们以用户注册和登录验证为例，讲讲密码加密后如何进行密码正确性验证。</p><h4 id="_1-1-注册过程" tabindex="-1"><a class="header-anchor" href="#_1-1-注册过程" aria-hidden="true">#</a> 1.1 注册过程</h4><p>以下过程省略<u>用户名验证</u>和<u>密码复杂度限制</u>等</p><ol><li>前端首先对用户密码进行固定规则加密，生成加密字符串作为密码</li><li>后端接收前端创建用户请求，解析得到用户数据 <code>{username: &#39;mittacy&#39;, password: &#39;加密字符串&#39;}</code></li><li>采用某种加密算法再次进行加密，得到一串的字符串 <code>5e884898da28047151d0e56f8dc62</code></li><li>将 <code>{username: &#39;mittacy&#39;, password: &#39;5e884898da28047151d0e56f8dc62&#39;}</code> 插入数据库，返回注册成功</li></ol><h4 id="_1-2-登录过程" tabindex="-1"><a class="header-anchor" href="#_1-2-登录过程" aria-hidden="true">#</a> 1.2 登录过程</h4><ol><li>前端首先采用注册时同样的加密规则对用户密码加密，生成加密字符串作为密码</li><li>后端接收前端用户登录请求，解析得到用户数据 <code>{username: &#39;mittacy&#39;, password: &#39;加密字符串&#39;}</code></li><li>通过 <code>username</code> 到数据库查询得到正确的加密密码字符串，记为 <code>password</code></li><li>采用注册过程中的加密算法对密码进行加密，得到一串的字符串 <code>5e884898da28047151d0e56f8dc62</code>，记为requestPassword</li><li>对比<code>requestPassword</code> 和 <code>password</code> ，相同返回 登录成功，否则返回 登录失败</li></ol><p>可以看到，我们存储的密码是加密后的字符串，并且不可逆，即使数据库泄露，攻击者也只能拿到这些加密后的字符串，几乎无法反推真正的密码，更加安全，只要及时修改密码即可。</p><p>那我们应该采用哪种加密算法呢？首先明确要求：</p><ul><li>同一个密码 使用算法加密后 产生的字符串始终都是一样的</li><li>不同密码 使用算法加密后 的字符要尽可能的不同(理论上没法确保一定不同)</li><li>不可逆的，不能从加密字符串倒推出密码</li></ul><h3 id="_2-加密算法分类" tabindex="-1"><a class="header-anchor" href="#_2-加密算法分类" aria-hidden="true">#</a> 2. 加密算法分类</h3><ul><li><code>对称加密算法</code> 加密解密都是用同一个密钥，有AES、DES等</li><li><code>非对称加密算法</code> 加密解密使用不同的密钥：公钥和私钥，最有名的就是RSA</li><li><code>单向Hash算法</code> 主要用于验证，防止信息被修改，有 MD5、SHA1、SHA256、SHA512等</li></ul><p>对称加密和非对称加密都不符合我们的要求，因为数据库泄露了，密钥也很有可能泄露，这两种算法都能解密获取原密码。</p><p>单向Hash算法，比如MD5，无法通过计算还原出原始密码，而且两个字符串就算只是相差一个字符，计算出来的加密字符串也大不相同，重合率较低，所以很适合用来加密用户密码</p><p>关于MD5原理，有一篇有趣的文章可以看看 <a href="https://www.tomorrow.wiki/archives/503" target="_blank" rel="noopener noreferrer">漫画趣解MD5</a></p><p>以为这样子就可以安枕无忧了吗？当然不是。</p><h3 id="_3-彩虹表攻击" tabindex="-1"><a class="header-anchor" href="#_3-彩虹表攻击" aria-hidden="true">#</a> 3. 彩虹表攻击</h3><p>彩虹表原理：<a href="https://blog.csdn.net/whatday/article/details/88527936/" target="_blank" rel="noopener noreferrer">高效的密码攻击方法：彩虹表</a></p><h3 id="_4-防御彩虹表" tabindex="-1"><a class="header-anchor" href="#_4-防御彩虹表" aria-hidden="true">#</a> 4. 防御彩虹表</h3><h4 id="_4-1-客户端" tabindex="-1"><a class="header-anchor" href="#_4-1-客户端" aria-hidden="true">#</a> 4.1 客户端</h4><p>禁止使用简单的密码</p><h4 id="_4-2-服务端" tabindex="-1"><a class="header-anchor" href="#_4-2-服务端" aria-hidden="true">#</a> 4.2 服务端</h4><ul><li><p>使用更好的Hash算法</p><p>生成的字符串越长攻击者越难破解，但相应的计算速度越慢</p><p>下面是几种常用的单向Hash算法的对比</p><table><thead><tr><th>哈希</th><th>长度(bit)</th><th>数据库长度(byte)</th></tr></thead><tbody><tr><td>md5</td><td>128</td><td>16</td></tr><tr><td>sha1</td><td>160</td><td>20</td></tr><tr><td>sha256</td><td>256</td><td>32</td></tr><tr><td>sha512</td><td>512</td><td>64</td></tr></tbody></table></li><li><p>加盐</p><p>我们在收到用户注册的密码时，可以用一定的规则将密码和盐拼接组成新的密码串，再通过算法加密生成字符串存入数据库</p><p>随机盐使得彩虹表的建表难度大幅增加，随机盐的长度一般不能少于8字节</p></li></ul></div><!----><!--]--></div><div class="card catalog" data-v-dd29a953 data-v-280e4acd data-v-2e70653c><!--[--><div class="catalog-header" data-v-280e4acd>目录</div><div style="margin-top:5px;margin-bottom:5px;" class="line" data-v-280e4acd data-v-901d8423></div><div class="catalog-content" data-v-280e4acd><!--[--><div class="catalog-item-wrapper" data-v-280e4acd><!--[--><div class="catalog-item" data-v-3d6f5fbb><a class="catalog-item-link" style="opacity:1;font-weight:600;" href="#_1-用户注册和登录验证" data-v-3d6f5fbb><div class="vue-ellipsis" data-v-3d6f5fbb><div class="vue-ellipsis-js"><span class="vue-ellipsis-js-content"></span><span class="vue-ellipsis-js-ellipsis"><!--[--><!--[-->...<!--]--><!--[--><!--]--><!--]--></span></div></div></a></div><!----><!--]--><div style="margin-top:5px;margin-bottom:5px;" class="line" data-v-280e4acd data-v-901d8423></div></div><div class="catalog-item-wrapper" data-v-280e4acd><!--[--><div class="catalog-item" data-v-3d6f5fbb><a class="catalog-item-link" style="opacity:1;font-weight:600;" href="#_2-加密算法分类" data-v-3d6f5fbb><div class="vue-ellipsis" data-v-3d6f5fbb><div class="vue-ellipsis-js"><span class="vue-ellipsis-js-content"></span><span class="vue-ellipsis-js-ellipsis"><!--[--><!--[-->...<!--]--><!--[--><!--]--><!--]--></span></div></div></a></div><!----><!--]--><div style="margin-top:5px;margin-bottom:5px;" class="line" data-v-280e4acd data-v-901d8423></div></div><div class="catalog-item-wrapper" data-v-280e4acd><!--[--><div class="catalog-item" data-v-3d6f5fbb><a class="catalog-item-link" style="opacity:1;font-weight:600;" href="#_3-彩虹表攻击" data-v-3d6f5fbb><div class="vue-ellipsis" data-v-3d6f5fbb><div class="vue-ellipsis-js"><span class="vue-ellipsis-js-content"></span><span class="vue-ellipsis-js-ellipsis"><!--[--><!--[-->...<!--]--><!--[--><!--]--><!--]--></span></div></div></a></div><!----><!--]--><div style="margin-top:5px;margin-bottom:5px;" class="line" data-v-280e4acd data-v-901d8423></div></div><div class="catalog-item-wrapper" data-v-280e4acd><!--[--><div class="catalog-item" data-v-3d6f5fbb><a class="catalog-item-link" style="opacity:1;font-weight:600;" href="#_4-防御彩虹表" data-v-3d6f5fbb><div class="vue-ellipsis" data-v-3d6f5fbb><div class="vue-ellipsis-js"><span class="vue-ellipsis-js-content"></span><span class="vue-ellipsis-js-ellipsis"><!--[--><!--[-->...<!--]--><!--[--><!--]--><!--]--></span></div></div></a></div><!----><!--]--><!----></div><!--]--></div><!--]--></div></div><!--]--></div><div class="footer" data-v-a231a75e data-v-21eb7198><section class="footer-section" data-v-21eb7198>©2023 Mittacy. All rights reserved</section><!--[--><section class="footer-section" data-v-21eb7198><span data-v-21eb7198>备案号: 粤ICP备2021130319号-1</span></section><section class="footer-section" data-v-21eb7198><a href="https://beian.miit.gov.cn" target="_blank" rel="noopener noreferrer" data-v-21eb7198></a></section><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/blog/assets/app-c399b13a.js" defer></script>
  </body>
</html>
