<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.64">
    <title>Docker常用服务安装 | Vuepress Theme Blue</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-0b99fa56.css" as="style"><link rel="stylesheet" href="/assets/style-0b99fa56.css">
    <link rel="modulepreload" href="/assets/app-a6a5d4a7.js"><link rel="modulepreload" href="/assets/index.html-66c19831.js"><link rel="modulepreload" href="/assets/index.html-df93660b.js"><link rel="prefetch" href="/assets/404.html-30afe3c5.js" as="script"><link rel="prefetch" href="/assets/index.html-87180724.js" as="script"><link rel="prefetch" href="/assets/index.html-ed0fd3d1.js" as="script"><link rel="prefetch" href="/assets/index.html-817918d0.js" as="script"><link rel="prefetch" href="/assets/index.html-ab2771d8.js" as="script"><link rel="prefetch" href="/assets/index.html-62bdddc1.js" as="script"><link rel="prefetch" href="/assets/index.html-0aaea317.js" as="script"><link rel="prefetch" href="/assets/index.html-362e5eda.js" as="script"><link rel="prefetch" href="/assets/index.html-22e9a1e5.js" as="script"><link rel="prefetch" href="/assets/index.html-03899184.js" as="script"><link rel="prefetch" href="/assets/index.html-bd04de7d.js" as="script"><link rel="prefetch" href="/assets/index.html-8432d7c2.js" as="script"><link rel="prefetch" href="/assets/index.html-f4bc7919.js" as="script"><link rel="prefetch" href="/assets/index.html-266cfb01.js" as="script"><link rel="prefetch" href="/assets/index.html-b2cc8270.js" as="script"><link rel="prefetch" href="/assets/index.html-98c00800.js" as="script"><link rel="prefetch" href="/assets/index.html-ae33ec0f.js" as="script"><link rel="prefetch" href="/assets/index.html-9f76b2fb.js" as="script"><link rel="prefetch" href="/assets/index.html-a8dc90b6.js" as="script"><link rel="prefetch" href="/assets/index.html-3d3599dc.js" as="script"><link rel="prefetch" href="/assets/index.html-23399167.js" as="script"><link rel="prefetch" href="/assets/index.html-404c3b2e.js" as="script"><link rel="prefetch" href="/assets/index.html-a9560cb8.js" as="script"><link rel="prefetch" href="/assets/index.html-0a493daa.js" as="script"><link rel="prefetch" href="/assets/index.html-cdee76d8.js" as="script"><link rel="prefetch" href="/assets/index.html-0e1d1c06.js" as="script"><link rel="prefetch" href="/assets/index.html-f692a8a6.js" as="script"><link rel="prefetch" href="/assets/index.html-b5f11fde.js" as="script"><link rel="prefetch" href="/assets/index.html-bb530bb0.js" as="script"><link rel="prefetch" href="/assets/index.html-0c076014.js" as="script"><link rel="prefetch" href="/assets/index.html-e965da56.js" as="script"><link rel="prefetch" href="/assets/index.html-d03c30ac.js" as="script"><link rel="prefetch" href="/assets/index.html-3f6e11fd.js" as="script"><link rel="prefetch" href="/assets/index.html-718a010f.js" as="script"><link rel="prefetch" href="/assets/index.html-b53b6fcb.js" as="script"><link rel="prefetch" href="/assets/index.html-023f9a25.js" as="script"><link rel="prefetch" href="/assets/index.html-52791d54.js" as="script"><link rel="prefetch" href="/assets/index.html-782e61bb.js" as="script"><link rel="prefetch" href="/assets/index.html-98c2c35b.js" as="script"><link rel="prefetch" href="/assets/index.html-fabfc81c.js" as="script"><link rel="prefetch" href="/assets/index.html-8fb78894.js" as="script"><link rel="prefetch" href="/assets/index.html-620675de.js" as="script"><link rel="prefetch" href="/assets/index.html-b7cf35a2.js" as="script"><link rel="prefetch" href="/assets/index.html-e14ec4b7.js" as="script"><link rel="prefetch" href="/assets/index.html-d9618c98.js" as="script"><link rel="prefetch" href="/assets/index.html-295b3ade.js" as="script"><link rel="prefetch" href="/assets/index.html-3da56c89.js" as="script"><link rel="prefetch" href="/assets/index.html-ea362abf.js" as="script"><link rel="prefetch" href="/assets/index.html-f5f5632b.js" as="script"><link rel="prefetch" href="/assets/index.html-164449d6.js" as="script"><link rel="prefetch" href="/assets/index.html-4b594f0f.js" as="script"><link rel="prefetch" href="/assets/index.html-3ff531d7.js" as="script"><link rel="prefetch" href="/assets/404.html-99967f39.js" as="script"><link rel="prefetch" href="/assets/index.html-02bedc7d.js" as="script"><link rel="prefetch" href="/assets/index.html-32ba965a.js" as="script"><link rel="prefetch" href="/assets/index.html-8d2845c0.js" as="script"><link rel="prefetch" href="/assets/index.html-7e3b40a2.js" as="script"><link rel="prefetch" href="/assets/index.html-5e14943c.js" as="script"><link rel="prefetch" href="/assets/index.html-8ddd90f6.js" as="script"><link rel="prefetch" href="/assets/index.html-199bc0b0.js" as="script"><link rel="prefetch" href="/assets/index.html-f8b17ccb.js" as="script"><link rel="prefetch" href="/assets/index.html-1ff18482.js" as="script"><link rel="prefetch" href="/assets/index.html-731a621f.js" as="script"><link rel="prefetch" href="/assets/index.html-cb2cf034.js" as="script"><link rel="prefetch" href="/assets/index.html-ffdd0bf6.js" as="script"><link rel="prefetch" href="/assets/index.html-42d4917e.js" as="script"><link rel="prefetch" href="/assets/index.html-9a0a97b3.js" as="script"><link rel="prefetch" href="/assets/index.html-81eaf5de.js" as="script"><link rel="prefetch" href="/assets/index.html-ebb9ee77.js" as="script"><link rel="prefetch" href="/assets/index.html-23c0d38b.js" as="script"><link rel="prefetch" href="/assets/index.html-816f6ec1.js" as="script"><link rel="prefetch" href="/assets/index.html-e9073f0e.js" as="script"><link rel="prefetch" href="/assets/index.html-e96cc586.js" as="script"><link rel="prefetch" href="/assets/index.html-a6758ea4.js" as="script"><link rel="prefetch" href="/assets/index.html-8cc81fbf.js" as="script"><link rel="prefetch" href="/assets/index.html-d3d05473.js" as="script"><link rel="prefetch" href="/assets/index.html-6170b0bf.js" as="script"><link rel="prefetch" href="/assets/index.html-30911cd4.js" as="script"><link rel="prefetch" href="/assets/index.html-33b21e52.js" as="script"><link rel="prefetch" href="/assets/index.html-5e65c1b9.js" as="script"><link rel="prefetch" href="/assets/index.html-2a164f81.js" as="script"><link rel="prefetch" href="/assets/index.html-2147f896.js" as="script"><link rel="prefetch" href="/assets/index.html-11385ea4.js" as="script"><link rel="prefetch" href="/assets/index.html-e02a98c4.js" as="script"><link rel="prefetch" href="/assets/index.html-e7298fb0.js" as="script"><link rel="prefetch" href="/assets/index.html-ef1df29b.js" as="script"><link rel="prefetch" href="/assets/index.html-82ec9c97.js" as="script"><link rel="prefetch" href="/assets/index.html-51dc7c9c.js" as="script"><link rel="prefetch" href="/assets/index.html-f8e6c09a.js" as="script"><link rel="prefetch" href="/assets/index.html-d7237f1b.js" as="script"><link rel="prefetch" href="/assets/index.html-264956b9.js" as="script"><link rel="prefetch" href="/assets/index.html-c0aca1d1.js" as="script"><link rel="prefetch" href="/assets/index.html-77117f6a.js" as="script"><link rel="prefetch" href="/assets/index.html-ece5da38.js" as="script"><link rel="prefetch" href="/assets/index.html-00db6cca.js" as="script"><link rel="prefetch" href="/assets/index.html-fd95335e.js" as="script"><link rel="prefetch" href="/assets/index.html-14649045.js" as="script"><link rel="prefetch" href="/assets/index.html-6546a4e6.js" as="script"><link rel="prefetch" href="/assets/index.html-9b4e410e.js" as="script"><link rel="prefetch" href="/assets/index.html-9aa4d534.js" as="script"><link rel="prefetch" href="/assets/index.html-05b76199.js" as="script"><link rel="prefetch" href="/assets/index.html-3caeb87d.js" as="script"><link rel="prefetch" href="/assets/index.html-9d0d9115.js" as="script"><link rel="prefetch" href="/assets/index.html-ad57ae51.js" as="script"><link rel="prefetch" href="/assets/giscus-2a044aea-497f0bd4.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><div class="nav" data-v-a231a75e data-v-ad3cbd41><div class="container" data-v-ad3cbd41><!--[--><a href="/" class="nav-action-wrapper" data-v-ad3cbd41><div class="nav-action" data-v-ad3cbd41>首页</div></a><a href="/category" class="nav-action-wrapper" data-v-ad3cbd41><div class="nav-action" data-v-ad3cbd41>分类</div></a><!--]--></div></div><div class="container" data-v-a231a75e><!--[--><div class="blog-page" data-v-dd29a953><div class="card blog" data-v-dd29a953 data-v-2e70653c><!--[--><!----><h1 class="title" data-v-dd29a953>Docker常用服务安装</h1><div class="markdown-body content" data-v-dd29a953><p>安装docker: <a href="https://blog.mittacy.com/article/47" target="_blank" rel="noopener noreferrer">Ubuntu安装docker</a></p><h3 id="_1-安装mysql" tabindex="-1"><a class="header-anchor" href="#_1-安装mysql" aria-hidden="true">#</a> 1. 安装mysql</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 下载mysql镜像</span>
$ <span class="token function">docker</span> pull mysql
<span class="token comment"># 查看下载情况</span>
$ <span class="token function">docker</span> images
<span class="token comment"># 运行mysql容器</span>
$ <span class="token function">docker</span> run <span class="token parameter variable">--name</span> mysql <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>password mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>参数说明：</p><ul><li><code>--name</code> 容器的名字</li><li><code>-d</code>：后台运行容器</li><li><code>-e</code>：设置参数</li><li><code>-p 3306:3306</code> 映射容器服务的 3306 端口到宿主机的 3306 端口，外部主机可以直接通过 <strong>宿主机ip:3306</strong> 访问到 MySQL 的服务</li><li><code>MYSQL_ROOT_PASSWORD</code> mysql服务root用户的密码</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 查看 mysql 运行情况</span>
$ <span class="token function">docker</span> <span class="token function">ps</span>
<span class="token comment"># 使用宿主登录mysql</span>
$ mysql <span class="token parameter variable">-h</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span>
<span class="token comment"># 进入容器</span>
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> mysql /bin/bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>挂载数据</strong></p><p>如果没有其他操作，这样的mysql数据库，每次终止运行后将丢失数据，非常糟糕，需要用到挂载数据：将宿主的一个位置挂载到容器内，对数据卷的修改会立马生效</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 删除原来的容器</span>
<span class="token comment"># 创建宿主目录</span>
$ <span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> ~/data/mysql/conf
$ <span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> ~/data/mysql/data
<span class="token comment"># 创建my.cnf配置文件</span>
$ <span class="token builtin class-name">cd</span> ~/data/mysql/conf
$ <span class="token function">sudo</span> <span class="token function">vim</span> my.cnf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>my.cnf</code>内容如下</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
<span class="token assign-left variable">user</span><span class="token operator">=</span>mysql
character-set-server<span class="token operator">=</span>utf8
<span class="token punctuation">[</span>client<span class="token punctuation">]</span>
default-character-set<span class="token operator">=</span>utf8
<span class="token punctuation">[</span>mysql<span class="token punctuation">]</span>
default-character-set<span class="token operator">=</span>utf8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新新建容器：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">docker</span> run <span class="token parameter variable">--name</span><span class="token operator">=</span>mysql <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">-v</span> ~/data/mysql/conf:/etc/mysql/conf.d <span class="token parameter variable">-v</span> ~/data/mysql/data:/var/lib/mysql <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>password mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>其中：</p><ul><li><p><code>-v ~/data/docker-mysql/conf/my.cnf:/etc/mysql/my.cnf</code></p><p>将本地<code>~/data/docker-mysql/conf/my.cnf</code>挂载到容器<code>/etc/mysql/my.cnf</code>，也就是访问<code>/etc/mysql/my.cnf</code>的时候其实访问的是<code>~/data/docker-mysql/conf/my.cnf</code></p></li><li><p><code>-v ~/data/docker-mysql/data:/var/lib/mysql</code> 同上一样的意思</p></li></ul><p>注意：如果出现mysql无法启动mysql或者启动闪退的情况，可以看看是不是没开启swap</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">free</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果发现swap虚拟内存都是0，应该就是swap未启用，启用swap：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span>/swapfile <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">1024</span>
$ <span class="token function">mkswap</span> /swapfile
$ <span class="token function">swapon</span> /swapfile
$ <span class="token function">free</span>
$ <span class="token function">docker</span> start mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-安装redis" tabindex="-1"><a class="header-anchor" href="#_2-安装redis" aria-hidden="true">#</a> 2. 安装redis</h3><p>创建redis宿主目录</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> ~/data/redis/conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>创建cnf文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token builtin class-name">cd</span> ~/data/redis/conf
$ <span class="token function">touch</span> redis.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>启动容器</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">docker</span> pull redis
$ <span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> redis <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 <span class="token parameter variable">-v</span> ~/data/redis/conf:/usr/local/etc/redis redis redis-server <span class="token parameter variable">--appendonly</span> <span class="token function">yes</span> <span class="token parameter variable">--requirepass</span> <span class="token string">&quot;mypassword&quot;</span>
$ redis-cli
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>--appendonly</code>：启用数据持久化保存</li><li><code>redis-server --appendonly yes</code>：在容器执行redis-server启动命令，并且启动redis持久化配置</li><li><code>/data/redis/conf</code> 需要有配置文件conf</li><li><code>--requirepass</code> 密码</li></ul><p>查看执行情况</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">docker</span> <span class="token function">ps</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><!----><!--]--></div><div class="card catalog" data-v-dd29a953 data-v-280e4acd data-v-2e70653c><!--[--><div class="catalog-header" data-v-280e4acd>目录</div><div style="margin-top:5px;margin-bottom:5px;" class="line" data-v-280e4acd data-v-901d8423></div><div class="catalog-content" data-v-280e4acd><!--[--><div class="catalog-item-wrapper" data-v-280e4acd><!--[--><div class="catalog-item" data-v-3d6f5fbb><a class="catalog-item-link" style="opacity:1;font-weight:600;" href="#_1-安装mysql" data-v-3d6f5fbb><div class="vue-ellipsis" data-v-3d6f5fbb><div class="vue-ellipsis-js"><span class="vue-ellipsis-js-content"></span><span class="vue-ellipsis-js-ellipsis"><!--[--><!--[-->...<!--]--><!--[--><!--]--><!--]--></span></div></div></a></div><!----><!--]--><div style="margin-top:5px;margin-bottom:5px;" class="line" data-v-280e4acd data-v-901d8423></div></div><div class="catalog-item-wrapper" data-v-280e4acd><!--[--><div class="catalog-item" data-v-3d6f5fbb><a class="catalog-item-link" style="opacity:1;font-weight:600;" href="#_2-安装redis" data-v-3d6f5fbb><div class="vue-ellipsis" data-v-3d6f5fbb><div class="vue-ellipsis-js"><span class="vue-ellipsis-js-content"></span><span class="vue-ellipsis-js-ellipsis"><!--[--><!--[-->...<!--]--><!--[--><!--]--><!--]--></span></div></div></a></div><!----><!--]--><!----></div><!--]--></div><!--]--></div></div><!--]--></div><div class="footer" data-v-a231a75e data-v-21eb7198><section class="footer-section" data-v-21eb7198>©2023 Mittacy. All rights reserved</section><!--[--><section class="footer-section" data-v-21eb7198><span data-v-21eb7198>备案号: 粤ICP备2021130319号-1</span></section><section class="footer-section" data-v-21eb7198><a href="https://beian.miit.gov.cn" target="_blank" rel="noopener noreferrer" data-v-21eb7198></a></section><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-a6a5d4a7.js" defer></script>
  </body>
</html>
